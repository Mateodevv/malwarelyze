# Malwarelyze


```
              _                        _               
  /\/\   __ _| |_      ____ _ _ __ ___| |_   _ _______ 
 /    \ / _` | \ \ /\ / / _` | '__/ _ \ | | | |_  / _ \
/ /\/\ \ (_| | |\ V  V / (_| | | |  __/ | |_| |/ /  __/
\/    \/\__,_|_| \_/\_/ \__,_|_|  \___|_|\__, /___\___|
                                         |___/         
```

This project is a tool for an automated malware analysis pipeline.

## Table of Contents

- [Features](#features)
- [Installation](#installation)
- [Usage](#usage)
- [Output Options](#output-options)
- [Upcoming Features](#upcoming-features)

## Features

- Monitor a directory and auto analyze every new file generated in the directory
- Automated single file analysis
- Automated single ip analysis
- Automated single url analysis
- Automated reports sent to your graylog instance!


## Installation

To install the project, follow these steps:

1. Clone the repository:

```bash 
git clone https://github.com/username/repo.git
```

2. Install the required packages: 
```bash 
pip install -r requirements.txt
```
## Usage
To print the help use the following command:

```bash
python3 malwarelyze.py --help
```

To use the project you can use the following commands to output the results to a file.

monitor directory and auto analyze new files:
```bash
python3 malwarelyze.py --dir </path/to/monitored/dir> --apikey <API_KEY> -oF
```

single file analysis:
```bash
python3 malwarelyze.py --file </path/to/file> --apikey <API_KEY> -oF
```
single ip analysis:
```bash
python3 malwarelyze.py --ip <ip> --apikey <API_KEY> -oF
```
single url analysis:
```bash
python3 malwarelyze.py --url <url> --apikey <API_KEY> -oF
```

## Output Options
If the -oF flag is provided, a file with the reports is being generated in the "reports" folder (if there is no reports folder one will be created automatically).
```bash
-oF
```
If the -oG flag is provided, the report data will be sent to a graylog DELF endpoint. Note that you need to provide a open DELF port.
```bash
-oG 127.0.0.1:12201
```

---------------**CAUTION**----------------

You need to provide at least one of the two flags. You can also provide both.

## Upcoming Features

- Automated Malware Sandbox Analysis
- Syslog output
- MITRE Mapping
- YARA Engine